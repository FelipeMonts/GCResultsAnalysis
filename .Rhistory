Year = 2021
PeakArea.results <- read.csv(file = paste0("FluxDataAnalysisResults\\GCcompiledResults" , Year ,".csv" ) , header = T)
str(PeakArea.results)
unique(PeakArea.results$Sampling.Day)
tail(unique(PeakArea.results$Sampling.Date))
head(PeakArea.results)
which(is.na(PeakArea.results))
GC.standards <- PeakArea.results[grep( pattern = "B" , x = PeakArea.results$Sample.Name, invert = T) ,] ;
which(is.na(GC.standards))
str(GC.standards)
GC.standards$Factor.Name <- as.factor(GC.standards$Sample.Name) ;
str(GC.standards$Sample.Name)
str(GC.standards$Factor.Name)
GC.standards$CH4.ppm <- NaN
GC.standards$CO2.ppm <- NaN
GC.standards$N2O.ppm <- NaN
levels(GC.standards$Factor.Name)
head(GC.standards);
if(Year == 2021) {
# Levels Names for 2021
# [1] "0PerSTD"    "0PerSTDA"   "100PerSTD"  "100PerSTDA" "25PerSTD"   "25PerSTDA"  "50PerSTD"   "50PerSTDA"  "75PerSTD"
# [10] "75PerSTDA"
# CH4	CO2	N2O
# 0perSTD	ppm 	uL/Lgas	0	0	0
# 25perSTDA	ppm 	uL/Lgas	1.25	125	0.25
# 50perSTDA	ppm 	uL/Lgas	2.5	250	0.5
# 75perSTDA	ppm 	uL/Lgas	3.75	375	0.75
# 100perSTDA	ppm 	uL/Lgas	5	500	1
# 25perSTD	ppm  uL/Lgas 12.5 1250 1.25
# 50PerSTD	ppm 	uL/Lgas	25	2500	25
# 75perSTD	ppm 	uL/Lgas	37.5	3750	37.5
# 100PerSTD	ppm 	uL/Lgas	50	5000	50
GC.standards[GC.standards$Sample.Name == "100PerSTDA",c('CH4.ppm')] <- 5 ;
GC.standards[GC.standards$Sample.Name == "100PerSTDA",c('CO2.ppm')] <- 500 ;
GC.standards[GC.standards$Sample.Name == "100PerSTDA",c('N2O.ppm')] <- 1 ;
GC.standards[GC.standards$Sample.Name == '100PerSTD',c('CH4.ppm')] <- 50 ;
GC.standards[GC.standards$Sample.Name == '100PerSTD',c('CO2.ppm')] <- 5000 ;
GC.standards[GC.standards$Sample.Name == '100PerSTD',c('N2O.ppm')] <- 50 ;
GC.standards[GC.standards$Sample.Name == "50PerSTDA",c('CH4.ppm')] <- 2.5  ;
GC.standards[GC.standards$Sample.Name == "50PerSTDA",c('CO2.ppm')] <- 250  ;
GC.standards[GC.standards$Sample.Name == "50PerSTDA",c('N2O.ppm')] <- 0.5  ;
GC.standards[GC.standards$Sample.Name == '50PerSTD',c('CH4.ppm')] <- 25 ;
GC.standards[GC.standards$Sample.Name == '50PerSTD',c('CO2.ppm')] <- 2500 ;
GC.standards[GC.standards$Sample.Name == '50PerSTD',c('N2O.ppm')] <- 25;
GC.standards[GC.standards$Sample.Name == '75PerSTDA',c('CH4.ppm')] <- 3.75 ;
GC.standards[GC.standards$Sample.Name == '75PerSTDA',c('CO2.ppm')] <- 375  ;
GC.standards[GC.standards$Sample.Name == '75PerSTDA',c('N2O.ppm')] <- 0.75 ;
GC.standards[GC.standards$Sample.Name == '75PerSTD',c('CH4.ppm')] <- 37.5 ;
GC.standards[GC.standards$Sample.Name == '75PerSTD',c('CO2.ppm')] <- 3750  ;
GC.standards[GC.standards$Sample.Name == '75PerSTD',c('N2O.ppm')] <- 37.5 ;
GC.standards[GC.standards$Sample.Name == "25PerSTDA",c('CH4.ppm')] <- 1.25 ;
GC.standards[GC.standards$Sample.Name == "25PerSTDA",c('CO2.ppm')] <- 125  ;
GC.standards[GC.standards$Sample.Name == "25PerSTDA",c('N2O.ppm')] <- 0.25  ;
GC.standards[GC.standards$Sample.Name == "25PerSTD",c('CH4.ppm')] <- 12.5 ;
GC.standards[GC.standards$Sample.Name == "25PerSTD",c('CO2.ppm')] <- 1250  ;
GC.standards[GC.standards$Sample.Name == "25PerSTD",c('N2O.ppm')] <- 0.25  ;
GC.standards[GC.standards$Sample.Name == "0PerSTD" |  GC.standards$Sample.Name == "0PerSTDA" ,
c('CH4.ppm', 'CO2.ppm', 'N2O.ppm')] <- 1e-5
GC.standards[which(is.na(GC.standards[,c('CH4.ppm')])), ]
GC.standards[which(is.na(GC.standards[,c('CO2.ppm')])), ]
GC.standards[which(is.na(GC.standards[,c('N2O.ppm')])), c('Sample.Name')]
} else {
# Levels Names for 2022
# [1] "0"    "H100" "H50"  "L100" "L25"  "L50"
# Values of the standards
# CH4	CO2	N2O
# 0 perSTD	ppm 	uL/Lgas	0	0	0
# L25 perSTDA	ppm 	uL/Lgas	1.25	125	0.25
# L50 perSTDA	ppm 	uL/Lgas	2.5	250	0.5
# L75 perSTDA	ppm 	uL/Lgas	3.75	375	0.75
# L100 perSTDA	ppm 	uL/Lgas	5	500	1
# H50 PerSTD	ppm 	uL/Lgas	25	2500	25
# H100 PerSTD	ppm 	uL/Lgas	100	5000	50
GC.standards[GC.standards$Sample.Name == 'L100',c('CH4.ppm')] <- 5 ;
GC.standards[GC.standards$Sample.Name == 'L100',c('CO2.ppm')] <- 500 ;
GC.standards[GC.standards$Sample.Name == 'L100',c('N2O.ppm')] <- 1 ;
GC.standards[GC.standards$Sample.Name == 'H100',c('CH4.ppm')] <- 50 ;
GC.standards[GC.standards$Sample.Name == 'H100',c('CO2.ppm')] <- 5000 ;
GC.standards[GC.standards$Sample.Name == 'H100',c('N2O.ppm')] <- 50 ;
GC.standards[GC.standards$Sample.Name == 'L50',c('CH4.ppm')] <- 2.5  ;
GC.standards[GC.standards$Sample.Name == 'L50',c('CO2.ppm')] <- 250  ;
GC.standards[GC.standards$Sample.Name == 'L50',c('N2O.ppm')] <- 0.5  ;
GC.standards[GC.standards$Sample.Name == 'H50',c('CH4.ppm')] <- 25 ;
GC.standards[GC.standards$Sample.Name == 'H50',c('CO2.ppm')] <- 2500 ;
GC.standards[GC.standards$Sample.Name == 'H50',c('N2O.ppm')] <- 25;
GC.standards[GC.standards$Sample.Name == '75PerSTDA',c('CH4.ppm')] <-3.75 ;
GC.standards[GC.standards$Sample.Name == '75PerSTDA',c('CO2.ppm')] <- 375  ;
GC.standards[GC.standards$Sample.Name == '75PerSTDA',c('N2O.ppm')] <- 0.75 ;
GC.standards[GC.standards$Sample.Name == '0',c('CH4.ppm', 'CO2.ppm', 'N2O.ppm')] <- 1e-5 ;
}
GC.standards$ANAL.DATE<-as.factor(GC.standards$GC.Date)  ;
xyplot(CO2 ~ CO2.ppm, groups = GC.Date, data=GC.standards, type="b", main="CO2", auto.key = T)
xyplot(CO2 ~ CO2.ppm | GC.Date , groups = Position , data=GC.standards, type="p",main="CO2", auto.key = T)
simpleKey(text = GC.standards$Position )
str(GC.standards)
if (Year == 2021) {
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "0PerSTD" | GC.standards$Factor.Name == "0PerSTDA",  ])
boxplot(CO2 ~ ANAL.DATE , data = GC.standards[GC.standards$Factor.Name == "0PerSTD" | GC.standards$Factor.Name == "0PerSTDA",  ]  )
boxplot(CH4 ~ ANAL.DATE , data = GC.standards[GC.standards$Factor.Name == "0PerSTD" | GC.standards$Factor.Name == "0PerSTDA",  ]  )
boxplot(N2O ~ ANAL.DATE , data = GC.standards[GC.standards$Factor.Name == "0PerSTD" | GC.standards$Factor.Name == "0PerSTDA",  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "25PerSTDA" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "25PerSTDA" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "50PerSTD" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "50PerSTD" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "50PerSTD" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "50PerSTD" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "100PerSTD" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "100PerSTD" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "50PerSTDA" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "50PerSTDA" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "100PerSTDA" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "100PerSTDA" ,  ]  )
boxplot(CH4 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "100PerSTDA" ,  ]  )
boxplot(N2O ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "100PerSTDA" ,  ]  )
xyplot(N2O~N2O.ppm, data=GC.standards, type="p",main="N2O")
xyplot(CH4~CH4.ppm, data=GC.standards, type="b",main="CH4")
}  else {
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "0" ,  ])
boxplot(CO2 ~ ANAL.DATE , data = GC.standards[GC.standards$Factor.Name == "0" ,  ]  )
boxplot(CH4 ~ ANAL.DATE , data = GC.standards[GC.standards$Factor.Name == "0" ,  ]  )
boxplot(N2O ~ ANAL.DATE , data = GC.standards[GC.standards$Factor.Name == "0" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "L25" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "L25" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "L50" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "L50" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "L100" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "L100" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "H50" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "H50" ,  ]  )
plot(CO2 ~ CO2.ppm, data = GC.standards[GC.standards$Factor.Name == "H100" ,  ])
boxplot(CO2 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "H100" ,  ]  )
boxplot(CH4 ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "H100" ,  ]  )
boxplot(N2O ~ ANAL.DATE, data = GC.standards[GC.standards$Factor.Name == "H100" ,  ]  )
xyplot(N2O~N2O.ppm, data=GC.standards, type="p",main="N2O")
xyplot(CH4~CH4.ppm, data=GC.standards, type="b",main="CH4")
}
str(GC.standards)
levels(GC.standards$ANAL.DATE)[[1]]
GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ]
plot(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ], col= "blue") ;
OLS.regression <- lm(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ] ) ;
summary(OLS.regression)
str(OLS.regression)
OLS.regression$coefficients[[1]]
abline(a = OLS.regression$coefficients[[1]], b = OLS.regression$coefficients[[2]] , col="red")
Quantile.Reg <- rq( CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ], tau = c(0.25, 0.50, 0.75) )
summary(Quantile.Reg)
str(Quantile.Reg)
abline(a = Quantile.Reg$coefficients[1,1], b = Quantile.Reg$coefficients[2,1] , col="cyan")
abline(a = Quantile.Reg$coefficients[1,2], b = Quantile.Reg$coefficients[2,2] , col="green")
abline(a = Quantile.Reg$coefficients[1,3], b = Quantile.Reg$coefficients[2,3] , col="magenta")
xyplot(CO2.ppm ~ CO2 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CO2", auto.key = T)
xyplot(CO2.ppm ~ CO2 , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
xyplot(N2O.ppm ~ N2O | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
xyplot(N2O.ppm ~ N2O , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
xyplot(CH4.ppm ~ CH4 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(200, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(200, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(400, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(400, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CH4", auto.key = T)
xyplot(CH4.ppm ~ CH4 , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(200, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(200, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(400, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(400, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CH4", auto.key = T)
CO2.Calibration <- lm(CO2.ppm ~ CO2 , data = GC.standards) ;
summary(CO2.Calibration)
N2O.Calibration <- lm(N2O.ppm ~ N2O , data = GC.standards) ;
summary(N2O.Calibration)
CH4.Calibration <- lm(CH4.ppm ~ CH4 , data = GC.standards) ;
summary(CH4.Calibration)
str(GC.standards)
str(PeakArea.results)
levels(GC.standards$Factor.Name)
GC.Data.NoSTD<-PeakArea.results[!(PeakArea.results$Sample.Name %in% levels(GC.standards$Factor.Name)),];
str(GC.Data.NoSTD)
plot.CH4.hist.dat<-hist(GC.Data.NoSTD$CH4)
plot.CH4.density.dat<-density(GC.Data.NoSTD$CH4, na.rm=T)
plot.CO2.hist.dat<-hist(GC.Data.NoSTD$CO2)
plot.CO2.density.dat<-density(GC.Data.NoSTD$CO2, na.rm=T)
plot.N2O.hist.dat<-hist(GC.Data.NoSTD$N2O)
plot.N2O.density.dat<-density(GC.Data.NoSTD$N2O, na.rm=T)
str(GC.Data.NoSTD)
GC.Data.NoSTD$CO2.Intercept <- coefficients(CO2.Calibration)[1] ;
GC.Data.NoSTD$CO2.Slope <- coefficients(CO2.Calibration)[2] ;
GC.Data.NoSTD$CO2.ppm <- (GC.Data.NoSTD$CO2 * GC.Data.NoSTD$CO2.Slope) + GC.Data.NoSTD$CO2.Intercept ;
GC.Data.NoSTD$N2O.Intercept <- coefficients(N2O.Calibration)[1] ;
coefficients(CO2.Calibration)[1]
coefficients(CO2.Calibration)[2]
GC.Data.NoSTD$CO2.ppm
coefficients(N2O.Calibration)[1]
coefficients(N2O.Calibration)[2]
coefficients(CH4.Calibration)[1]
coefficients(CH4.Calibration)[2]
CO2.Calibration <- lm(CO2.ppm ~ CO2 , data = GC.standards)
plot(CO2.Calibration)
plot(CO2.Calibration)
plot(CO2.ppm ~ CO2 , data = GC.standards)
plot(CO2.ppm ~ CO2 , data = GC.standards, lm = T)
abline(lm(CO2.ppm ~ CO2)
plot(CO2.ppm ~ CO2 , data = GC.standards)
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2))
abline(lm(CO2.ppm ~ CO2,data = GC.standards ))
CO2.Calibration <- lm(CO2.ppm ~ CO2 + 0 , data = GC.standards) ;
plot(CO2.Calibration)
plot(CO2.Calibration)
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2 + 0,data = GC.standards ))
summary(CO2.Calibration)
CO2.Calibration <- lm(CO2.ppm ~ CO2 , data = GC.standards) ;
plot(CO2.Calibration)
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards ))
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards ))
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards, col = "red" , lwt =3))
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards, col = "red" , lwd =3))
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards, col = "red" , lwd = 3))
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards), col = "red" , lwd = 2)
CO2.Calibration <- lm(CO2.ppm ~ CO2 , data = GC.standards) ;
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2 ,data = GC.standards), col = "red" , lwd = 2)
plot(CO2.Calibration)
CO2.Calibration <- lm(CO2.ppm ~ CO2 + 0 , data = GC.standards) ;
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2)
plot(CO2.Calibration)
str(OLS.regression)
OLS.regression <- lm(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ] ) ;
summary(OLS.regression)
str(OLS.regression)
OLS.regression$coefficients[[1]]
abline(a = OLS.regression$coefficients[[1]], b = OLS.regression$coefficients[[2]] , col="red")
str(GC.standards)
levels(GC.standards$ANAL.DATE)[[1]]
GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ]
plot(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ], col= "blue") ;
OLS.regression <- lm(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ] ) ;
summary(OLS.regression)
str(OLS.regression)
OLS.regression$coefficients[[1]]
abline(a = OLS.regression$coefficients[[1]], b = OLS.regression$coefficients[[2]] , col="red")
Quantile.Reg <- rq( CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ], tau = c(0.25, 0.50, 0.75) )
summary(Quantile.Reg)
str(Quantile.Reg)
abline(a = Quantile.Reg$coefficients[1,1], b = Quantile.Reg$coefficients[2,1] , col="cyan")
abline(a = Quantile.Reg$coefficients[1,2], b = Quantile.Reg$coefficients[2,2] , col="green")
abline(a = Quantile.Reg$coefficients[1,3], b = Quantile.Reg$coefficients[2,3] , col="magenta")
xyplot(CO2.ppm ~ CO2 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CO2", auto.key = T)
xyplot(CO2.ppm ~ CO2 , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
CO2.Calibration <- lm(CO2.ppm ~ CO2 + 0 , data = GC.standards) ;
plot(CO2.Calibration)
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2)
abline(eq(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "magenta" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "magenta" , lwd = 2)
xyplot(CO2.ppm ~ CO2 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CO2", auto.key = T)
xyplot(CO2.ppm ~ CO2 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CO2", auto.key = T)
xyplot(CO2.ppm ~ CO2 , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
str(GC.standards)
levels(GC.standards$ANAL.DATE)[[1]]
GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ]
plot(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ], col= "blue") ;
OLS.regression <- lm(CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ] ) ;
summary(OLS.regression)
str(OLS.regression)
OLS.regression$coefficients[[1]]
abline(a = OLS.regression$coefficients[[1]], b = OLS.regression$coefficients[[2]] , col="red")
Quantile.Reg <- rq( CO2~CO2.ppm, data = GC.standards[GC.standards$ANAL.DATE == levels(GC.standards$ANAL.DATE)[[8]], ], tau = c(0.25, 0.50, 0.75) )
summary(Quantile.Reg)
str(Quantile.Reg)
abline(a = Quantile.Reg$coefficients[1,1], b = Quantile.Reg$coefficients[2,1] , col="cyan")
abline(a = Quantile.Reg$coefficients[1,2], b = Quantile.Reg$coefficients[2,2] , col="green")
abline(a = Quantile.Reg$coefficients[1,3], b = Quantile.Reg$coefficients[2,3] , col="magenta")
xyplot(CO2.ppm ~ CO2 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CO2", auto.key = T)
xyplot(CO2.ppm ~ CO2 , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 4000,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 3500,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 2000,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 2500,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
xyplot(N2O.ppm ~ N2O | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
xyplot(N2O.ppm ~ N2O , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(10000, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(10000, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(20000, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(20000, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="N2O", auto.key = T)
xyplot(CH4.ppm ~ CH4 | GC.Date , groups = Series , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(200, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(200, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(400, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(400, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CH4", auto.key = T)
xyplot(CH4.ppm ~ CH4 , data=GC.standards,
panel = function(x, y) { panel.xyplot(x, y)
panel.xyplot(x, y)
panel.abline(lm(y ~ x), col = "BLACK", lwd = 2)
panel.abline(rq(y ~ x), col="RED" , lwd = 2)
panel.text(200, 40,labels = signif(rq(y ~ x)$coefficients[2], digits = 3), col = "red")
panel.text(200, 35,labels = signif(rq(y ~ x)$coefficients[1], digits = 3), col = "red")
panel.text(400, 20,labels = signif(lm(y ~ x)$coefficients[1], digits = 3), col = 'black' )
panel.text(400, 25,labels = signif(lm(y ~ x)$coefficients[2], digits = 3), col = 'black' )
},
type="b",main="CH4", auto.key = T)
CO2.Calibration <- lm(CO2.ppm ~ CO2 + 0 , data = GC.standards) ;
plot(CO2.Calibration)
N2O.Calibration <- lm(N2O.ppm ~ N2O , data = GC.standards) ;
summary(N2O.Calibration)
plot(CO2.ppm ~ CO2 , data = GC.standards)
GC.standards[GC.standards$CO2 >= 25000,]
GC.standards[-1768,]
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards[-1768,]), col = "blue" , lwd = 2)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards[-1768,]), col = "blue" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "magenta" , lwd = 2)
plot(CO2.ppm ~ CO2 , data = GC.standards, type = c (l + r))
plot(CO2.ppm ~ CO2 , data = GC.standards, type = c("l" + "r"))
plot(CO2.ppm ~ CO2 , data = GC.standards, type = "l")
plot(CO2.ppm ~ CO2 , data = GC.standards, type = "p")
plot(CO2.ppm ~ CO2 , data = GC.standards, type = c("p" + "r"))
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2 )
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards[-1768,]), col = "blue" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "magenta" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards[-1768,]), col = "green" , lwd = 2)
GC.standards[-1768,]
max(GC.standards[-1768, c("CO2")]
)
plot(CO2.ppm ~ CO2 , data = GC.standards)
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2 )
GC.standards.2 <- GC.standards[GC.standards$CO2<= 25000,] ;
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2 )
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards.2), col = "blue" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "magenta" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards.2), col = "green" , lwd = 2)
N2O.Calibration <- lm(N2O.ppm ~ N2O , data = GC.standards) ;
plot(N2O.ppm ~ N2O , data = GC.standards)
abline(lm(N2O.ppm ~ N2O , data = GC.standards), col = "red", lwd = 2)
abline(lm(N2O.ppm ~ N2O + 0 , data = GC.standards), col = "magenta", lwd = 2)
plot(N2O.Calibration)
N2O.Calibration <- lm(N2O.ppm ~ N2O + 0 , data = GC.standards) ;
plot(N2O.Calibration)
CH4.Calibration <- lm(CH4.ppm ~ CH4 , data = GC.standards) ;
plot(CH4.ppm ~ CH4 , data = GC.standards)
abline(lm(CH4.ppm ~ CH4 , data = GC.standards) , col = "red" , lwd = 2)
abline(lm(CH4.ppm ~ CH4 + 0 , data = GC.standards) , col = "red" , lwd = 2)
summary(CH4.Calibration)
abline(lm(CH4.ppm ~ CH4 + 0 , data = GC.standards) , col = "magenta" , lwd = 2)
N2O.Calibration <- lm(N2O.ppm ~ N2O + 0 , data = GC.standards) ;
plot(N2O.ppm ~ N2O , data = GC.standards)
plot(CH4.ppm ~ CH4 , data = GC.standards)
GC.standards <- GC.standards.2 ;
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "red" , lwd = 2 )
abline(lm(CO2.ppm ~ CO2  + 0 ,data = GC.standards.2), col = "blue" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards), col = "magenta" , lwd = 2)
abline(rq(CO2.ppm ~ CO2  + 0 ,data = GC.standards.2), col = "green" , lwd = 2)
summary(CO2.Calibration)
N2O.Calibration <- lm(N2O.ppm ~ N2O + 0 , data = GC.standards) ;
CO2.Calibration <- lm(CO2.ppm ~ CO2 + 0 , data = GC.standards) ;
CO2.Calibration
summary(CO2.Calibration)
plot(N2O.ppm ~ N2O , data = GC.standards)
N2O.Calibration <- lm(N2O.ppm ~ N2O  , data = GC.standards) ;
summary(N2O.Calibration)
N2O.Calibration <- lm(N2O.ppm ~ N2O + 0 , data = GC.standards) ;
summary(N2O.Calibration)
plot(CH4.ppm ~ CH4 , data = GC.standards)
CH4.Calibration <- lm(CH4.ppm ~ CH4 , data = GC.standards) ;
summary(CH4.Calibration)
CH4.Calibration <- lm(CH4.ppm ~ CH4 + 0, data = GC.standards) ;
summary(CH4.Calibration)
abline(lm(CH4.ppm ~ CH4, data = GC.standards) , col = "red" , lwd = 2)
abline(lm(CH4.ppm ~ CH4 + 0 , data = GC.standards) , col = "magenta" , lwd = 2)
