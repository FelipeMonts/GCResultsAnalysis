str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
tail(Concentration.Flux.Data)
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
}
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$f0.KgSubstance.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$LR.f0.KgElement.Ha.day <- Concentration.Flux.Data$LR.f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$LR.f0.KgSubstance.Ha.day <- Concentration.Flux.Data$LR.f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$Sampling.Date <- as.Date(Concentration.Flux.Data$Sampling.Date) ;
Concentration.Flux.Data$Exp.Unit.ID <- as.factor(paste0(Concentration.Flux.Data$BLOCK.F, ".",
Concentration.Flux.Data$CoverCrop.F, "." ,
Concentration.Flux.Data$Treatment.F) )
levels(Concentration.Flux.Data$Exp.Unit.ID)
i =1
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ]
main = i
i
i = "1.3Spp.A"
i = "1.3Spp.A"
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
delta.x <- as.numeric(diff.Date(
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")  ])) ;
y.1 <- head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("LR.f0.KgElement.Ha.day")  ],-1)
y.2 <- tail(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("LR.f0.KgElement.Ha.day")  ],-1)
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Cumm.Emissions.KgElement.Ha") ] <- sum(delta.x *(y.1 + y.2))/2
sum(delta.x *(y.1 + y.2))/2
delta.x <- as.numeric(diff.Date(
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")  ])) ;
y.1 <- head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("LR.f0.KgElement.Ha.day")  ],-1)
y.2 <- tail(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("LR.f0.KgElement.Ha.day")  ],-1)
sum(delta.x *(y.1 + y.2))/2
delta.x
setwd(paste0("D:\\Felipe\\Current_Projects\\CCC Based Experiments\\" ,
"StrategicTillage_NitrogenLosses_OrganicCoverCrops\\DataAnalysis\\RCode\\GCResultsAnalysis\\"))
getwd()
Year = 2021
Gas = "CO2"
Concentration.Flux.Data <- read.csv( file = paste0("FluxDataAnalysisResults\\" ,
Gas, "_Concentration.Flux.Data_", Year , ".csv"))  ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
###############################################################################################################
#
#  Calculation of flux mass rates based on concetration(volume) flux rates
#
#   Felipe Montes 2023/09/04
#
#############################################################################################################
###############################################################################################################
#                            Install the packages that are needed
###############################################################################################################
# install.packages("HMR",  dependencies = T)
###############################################################################################################
#                           load the libraries that are needed
###############################################################################################################
###############################################################################################################
# readClipboard()
###############################################################################################################
#                             Setting up working directory  Loading Packages and Setting up working directory
###############################################################################################################
#      set the working directory
# readClipboard()
setwd(paste0("D:\\Felipe\\Current_Projects\\CCC Based Experiments\\" ,
"StrategicTillage_NitrogenLosses_OrganicCoverCrops\\DataAnalysis\\RCode\\GCResultsAnalysis\\"))
getwd()
Year = 2021
Gas = "CO2"
Concentration.Flux.Data <- read.csv( file = paste0("FluxDataAnalysisResults\\" ,
Gas, "_Concentration.Flux.Data_", Year , ".csv"))  ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
R = 8.31446261815324
Patm = 101325
Concentration.Flux.Data$Temp.K <- 293.15 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$f0.mol.min <- Concentration.Flux.Data$f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data$f0.mol.min
is.na(Concentration.Flux.Data$f0.mol.min)
Concentration.Flux.Data[Which(is.na(Concentration.Flux.Data$f0.mol.min)),]
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$f0.mol.min)),]
Concentration.Flux.Data$f0.mol.min <- Concentration.Flux.Data$f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$f0.mol.min)),]
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("LR.f0")] <-
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Rev.LR.f0")]
Concentration.Flux.Data$LR.f0.mol.min <- Concentration.Flux.Data$LR.f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Prefilter.p")] <-
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Rev.Prefilter.p")]
Concentration.Flux.Data[Concentration.Flux.Data$Prefilter.p >= 0.05 , c("LR.f0.mol.min")] <- 1e-10 ;
str(Concentration.Flux.Data)
Concentration.Flux.Data[Concentration.Flux.Data$Prefilter.p >= 0.05 ,
]
Concentration.Flux.Data$LR.f0.mol.min
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
tail(Concentration.Flux.Data)
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
}
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
}
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
}
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$f0.KgSubstance.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$LR.f0.KgElement.Ha.day <- Concentration.Flux.Data$LR.f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$LR.f0.KgSubstance.Ha.day <- Concentration.Flux.Data$LR.f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$Sampling.Date <- as.Date(Concentration.Flux.Data$Sampling.Date) ;
Concentration.Flux.Data$Exp.Unit.ID <- as.factor(paste0(Concentration.Flux.Data$BLOCK.F, ".",
Concentration.Flux.Data$CoverCrop.F, "." ,
Concentration.Flux.Data$Treatment.F) )
levels(Concentration.Flux.Data$Exp.Unit.ID)
i = "1.3Spp.A"
delta.x <- as.numeric(diff.Date(
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")  ])) ;
delta.x
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")  ]
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")  ]
order(Concentration.Flux.Data$Exp.Unit.ID == i)
Concentration.Flux.Data[order(Concentration.Flux.Data$Exp.Unit.ID == i) ,c("Sampling.Date")  ])
Concentration.Flux.Data[order(Concentration.Flux.Data$Exp.Unit.ID == i) ,c("Sampling.Date")  ]
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ]
order(x.Date)
x.Date <- Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ];
order(x.Date)
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ]
order(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ])
str(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ])
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ]
order( as.Date (Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ]))
order(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ]));
Order.Date <- order(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")  ]);
order(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,])
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,]
X.Date <- Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,];
X.Date[order(X.Date$Sampling.Date) , ]
Order.by.Date <- X.Date[order(X.Date$Sampling.Date) , ]
Order.by.Date
diff.Date(Order.by.Date$Sampling.Date)
delta.x <- as.numeric(diff.Date(Order.by.Date$Sampling.Date)
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")  ])) ;
delta.x <- as.numeric(diff.Date(Order.by.Date$Sampling.Date))
delta.x
head(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day")  ],-1)
tail(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
sum(delta.x *(y.1 + y.2))/2
y.1 <- head(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
y.2 <- tail(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
sum(delta.x *(y.1 + y.2))/2
delta.x <- as.numeric(diff.Date(Order.by.Date$Sampling.Date))
delta.x
y.1
y.2
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Cumm.Emissions.KgElement.Ha") ] <- sum(delta.x *(y.1 + y.2), na.rm = T)/2
sum(delta.x *(y.1 + y.2), na.rm = T)/2
sum((delta.x *(y.1 + y.2))/2, na.rm = T)
cumsum((delta.x *(y.1 + y.2))/2, na.rm = T)
cumsum((delta.x *(y.1 + y.2))/2)
sum((delta.x *(y.1 + y.2))/2, na.rm = T)
cumsum((delta.x *(y.1 + y.2))/2)
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
]
Total.Cum.Emissions <- sum((delta.x *(y.1 + y.2))/2, na.rm = T)
Total.Cum.Emissions <- sum((delta.x *(y.1 + y.2))/2, na.rm = T)
Total.Cum.Emissions
Incre.Cum.Emissions
Incre.Cum.Emissions <- cumsum((delta.x *(y.1 + y.2))/2)
Incre.Cum.Emissions
Total.Cum.Emissions[[1]]
Order.by.Date[1,c("LR.f0.KgElement.Ha.day") ]
length(Order.by.Date)
dim(Order.by.Date)
dim(Order.by.Date)[[1]]
Order.by.Date[dim(Order.by.Date)[[1]],c("LR.f0.KgElement.Ha.day") ]
dim(Order.by.Date)[[1]]
dim(Order.by.Date)[1]
Order.by.Date[dim(Order.by.Date)[1],c("LR.f0.KgElement.Ha.day") ]
Order.by.Date
y.1 <- head(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
y.2 <- tail(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
Total.Cum.Emissions.1 <- sum((delta.x *(y.1 + y.2))/2, na.rm = T)
Total.Cum.Emissions.1
levels(Concentration.Flux.Data$Exp.Unit.ID)
i = "2.Clover.D"
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
]
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ]
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,]
Order.by.Date <- X.Date[order(X.Date$Sampling.Date) , ]
delta.x <- as.numeric(diff.Date(Order.by.Date$Sampling.Date))
y.1 <- head(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
y.2 <- tail(Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ],-1)
Total.Cum.Emissions.1 <- sum((delta.x *(y.1 + y.2))/2, na.rm = T)
Total.Cum.Emissions <- Total.Cum.Emissions.1 + Order.by.Date[1,c("LR.f0.KgElement.Ha.day") ] +
Order.by.Date[dim(Order.by.Date)[1],c("LR.f0.KgElement.Ha.day") ]
Incre.Cum.Emissions <- cumsum((delta.x *(y.1 + y.2))/2)
Incre.Cum.Emissions
Incre.Cum.Emissions[1]
Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ][1]
Incre.Cum.Emissions[1] <- Order.by.Date[ ,c("LR.f0.KgElement.Ha.day") ][1] ;
length(Incre.Cum.Emissions)
Incre.Cum.Emissions[length(Incre.Cum.Emissions)] <- Total.Cum.Emissions ;
Incre.Cum.Emissions
Total.Cum.Emissions
Concentration.Flux.Data[order(Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")) ,
]
Concentration.Flux.Data[order( Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,c("Sampling.Date")]) ,]
Concentration.Flux.Data[order(Concentration.Flux.Data$Sampling.Date),]
setwd(paste0("D:\\Felipe\\Current_Projects\\CCC Based Experiments\\" ,
"StrategicTillage_NitrogenLosses_OrganicCoverCrops\\DataAnalysis\\RCode\\GCResultsAnalysis\\"))
getwd()
Year = 2021
Gas = "CO2"
Concentration.Flux.Data <- read.csv( file = paste0("FluxDataAnalysisResults\\" ,
Gas, "_Concentration.Flux.Data_", Year , ".csv"))  ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$Sampling.Date <- as.Date(Concentration.Flux.Data$Sampling.Date)
Concentration.Flux.Data.1$Sampling.Date <- as.Date(Concentration.Flux.Data.1$Sampling.Date)
Concentration.Flux.Data.1 <- read.csv( file = paste0("FluxDataAnalysisResults\\" ,
Gas, "_Concentration.Flux.Data_", Year , ".csv"))  ;
Concentration.Flux.Data.1$Sampling.Date <- as.Date(Concentration.Flux.Data.1$Sampling.Date)
str(Concentration.Flux.Data.1)
Concentration.Flux.Data <- Concentration.Flux.Data.1[order(Concentration.Flux.Data.1$Sampling.Date),]
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
setwd(paste0("D:\\Felipe\\Current_Projects\\CCC Based Experiments\\" ,
"StrategicTillage_NitrogenLosses_OrganicCoverCrops\\DataAnalysis\\RCode\\GCResultsAnalysis\\"))
getwd()
Year = 2021
Gas = "CO2"
Concentration.Flux.Data.1 <- read.csv( file = paste0("FluxDataAnalysisResults\\" ,
Gas, "_Concentration.Flux.Data_", Year , ".csv"))  ;
Concentration.Flux.Data.1$Sampling.Date <- as.Date(Concentration.Flux.Data.1$Sampling.Date) ;
Concentration.Flux.Data <- Concentration.Flux.Data.1[order(Concentration.Flux.Data.1$Sampling.Date),]
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
R = 8.31446261815324
Patm = 101325
Concentration.Flux.Data$Temp.K <- 293.15 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$f0.mol.min <- Concentration.Flux.Data$f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$f0.mol.min)),]
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("LR.f0")] <-
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Rev.LR.f0")]
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$f0.mol.min)),]
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$LR.f0)),]
Concentration.Flux.Data$LR.f0.mol.min <- Concentration.Flux.Data$LR.f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Prefilter.p")] <-
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Rev.Prefilter.p")]
Concentration.Flux.Data[Concentration.Flux.Data$Prefilter.p >= 0.05 , c("LR.f0.mol.min")] <- 1e-10 ;
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$Prefilter.p)),]
Concentration.Flux.Data[Concentration.Flux.Data$Prefilter.p >= 0.05 , c("LR.f0.mol.min")] <- 1e-10 ;
Concentration.Flux.Data$Prefilter.p
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
tail(Concentration.Flux.Data)
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
}
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Element.Subtance.MW.Ratio <- Gas.Substance.MW / Gas.Element.MW
Element.Subtance.MW.Ratio
Gas == "CO2"
setwd(paste0("D:\\Felipe\\Current_Projects\\CCC Based Experiments\\" ,
"StrategicTillage_NitrogenLosses_OrganicCoverCrops\\DataAnalysis\\RCode\\GCResultsAnalysis\\"))
getwd()
Year = 2021
Gas = "CO2"
Concentration.Flux.Data.1 <- read.csv( file = paste0("FluxDataAnalysisResults\\" ,
Gas, "_Concentration.Flux.Data_", Year , ".csv"))  ;
Concentration.Flux.Data.1$Sampling.Date <- as.Date(Concentration.Flux.Data.1$Sampling.Date) ;
Concentration.Flux.Data <- Concentration.Flux.Data.1[order(Concentration.Flux.Data.1$Sampling.Date),]
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
R = 8.31446261815324
Patm = 101325
Concentration.Flux.Data$Temp.K <- 293.15 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$f0.mol.min <- Concentration.Flux.Data$f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$f0.mol.min)),]
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("LR.f0")] <-
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Rev.LR.f0")] ;
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$LR.f0)),]
Concentration.Flux.Data$LR.f0.mol.min <- Concentration.Flux.Data$LR.f0 * Patm / (R * Concentration.Flux.Data$Temp.K *1e6) ;
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Prefilter.p")] <-
Concentration.Flux.Data[Concentration.Flux.Data$Warning == "Data error" , c("Rev.Prefilter.p")] ;
Concentration.Flux.Data[which(is.na(Concentration.Flux.Data$Prefilter.p)),]
Concentration.Flux.Data[Concentration.Flux.Data$Prefilter.p >= 0.05 , c("LR.f0.mol.min")] <- 1e-10 ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
tail(Concentration.Flux.Data)
if (Gas == "CO2") {
Gas.Substance.MW <- 44.0095  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
} else {
if (Gas == "N2O") {
Gas.Substance.MW <- 44.0128  # g mol-1
Gas.Element.MW <- 14.0067  # g mol-1
} else {
if (Gas == "CH4")
Gas.Substance.MW <- 16.0425  # g mol-1
Gas.Element.MW <- 12.0107  # g mol-1
}
Element.Subtance.MW.Ratio <- Gas.Substance.MW / Gas.Element.MW
}
Element.Subtance.MW.Ratio
Element.Subtance.MW.Ratio
Element.Subtance.MW.Ratio <- Gas.Substance.MW / Gas.Element.MW
Element.Subtance.MW.Ratio
16.0425 / 12.0107
44.0128/ 12.0107
44.0095 / 12.0107
Concentration.Flux.Data$f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000
Concentration.Flux.Data$f0.KgElement.Ha.day * Element.Subtance.MW.Ratio
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$f0.KgElement.Ha.day * Element.Subtance.MW.Ratio  ;
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$f0.KgSubstance.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$f0.KgSubstance.Ha.day
Concentration.Flux.Data$f0.KgElement.Ha.day * Element.Subtance.MW.Ratio
Element.Subtance.MW.Ratio
Gas.Substance.MW
Gas.Element.MW
head(Concentration.Flux.Data$f0.mol.min)
head(Concentration.Flux.Data$f0.mol.min , 50)
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 ;
head(Concentration.Flux.Data$f0.KgElement.Ha.day, 50)
Concentration.Flux.Data$f0.KgElement.Ha.day <- Concentration.Flux.Data$f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
head(Concentration.Flux.Data$f0.KgElement.Ha.day, 50)
Concentration.Flux.Data$f0.KgSubstance.Ha.day <-  Concentration.Flux.Data$f0.KgElement.Ha.day * Element.Subtance.MW.Ratio;
head(Concentration.Flux.Data$ff0.KgSubstance.Ha.day, 50)
head(Concentration.Flux.Data$ff0.KgSubstance.Ha.day, 50)
Concentration.Flux.Data$f0.KgSubstance.Ha.day <-  Concentration.Flux.Data$f0.KgElement.Ha.day * Element.Subtance.MW.Ratio;
head(Concentration.Flux.Data$ff0.KgSubstance.Ha.day, 50)
head(Concentration.Flux.Data$f0.KgSubstance.Ha.day, 50)
head(Concentration.Flux.Data$f0.mol.min * Gas.Substance.MW * 1440 * 10000 / 1000 , 50)
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$LR.f0.KgElement.Ha.day <- Concentration.Flux.Data$LR.f0.mol.min * Gas.Element.MW * 1440 * 10000 / 1000 ;
Concentration.Flux.Data$LR.f0.KgSubstance.Ha.day <- Concentration.Flux.Data$LR.f0.KgElement.Ha.day * Element.Subtance.MW.Ratio ;
str(Concentration.Flux.Data)
head(Concentration.Flux.Data)
Concentration.Flux.Data$Exp.Unit.ID <- as.factor(paste0(Concentration.Flux.Data$BLOCK.F, ".",
Concentration.Flux.Data$CoverCrop.F, "." ,
Concentration.Flux.Data$Treatment.F) )
levels(Concentration.Flux.Data$Exp.Unit.ID)
i = "2.Clover.D"
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
i = "4.Clover.A"
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
i = "2.3Spp.A"
plot(LR.f0.KgElement.Ha.day ~ Sampling.Date,
data = Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,
c("Sampling.Date"  ,"LR.f0.KgElement.Ha.day")  ] , col = "blue",
ylab = paste0(Gas , "_KgElement.Ha.day"), main = i    ) ;
X.Date <-Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,];
X.Date
X.Date[order(X.Date$Sampling.Date) , ]
X.Date <-Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i ,];
Order.by.Date <- X.Date[order(X.Date$Sampling.Date) , ]
X.Date
Order.by.Date
diff.Date(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")])
as.numeric(diff.Date(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")]))
as.numeric(diff.Date(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")]))
head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("LR.f0.KgElement.Ha.day") ]
)
head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("LR.f0.KgElement.Ha.day") ])
head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("Sampling.Date") ])
head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("Sampling.Date") ])
tail(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("Sampling.Date") ])
head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("Sampling.Date") ]-1)
tail(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("Sampling.Date") ]-1)
head(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i,c("Sampling.Date") ])
delta.x
delta.x <- as.numeric(diff.Date(Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , c("Sampling.Date")]))
delta.x
Flux.Calc.Data <- Concentration.Flux.Data[Concentration.Flux.Data$Exp.Unit.ID == i , ]
Flux.Calc.Data
Flux.Calc.Data
dim.data.frame(Flux.Calc.Data)
seq(1:dim.data.frame(Flux.Calc.Data)[1])
Flux.Calc.Data[seq(1:dim.data.frame(Flux.Calc.Data)[1]), c("Sampling.Date")]
Flux.Calc.Data[seq(1:dim.data.frame(Flux.Calc.Data)[1]-1), c("Sampling.Date")] ;
seq(1:dim.data.frame(Flux.Calc.Data)[1]-1)
seq(1,dim.data.frame(Flux.Calc.Data)[1]-1)
Flux.Calc.Data[seq(2,dim.data.frame(Flux.Calc.Data)[1]), c("Sampling.Date")]
seq(2,dim.data.frame(Flux.Calc.Data)[1])
x.1 <- Flux.Calc.Data[seq(1,dim.data.frame(Flux.Calc.Data)[1]-1), c("Sampling.Date")] ;
X.2 <- Flux.Calc.Data[seq(2,dim.data.frame(Flux.Calc.Data)[1]), c("Sampling.Date")] ;
x.1 <- Flux.Calc.Data[seq(1,dim.data.frame(Flux.Calc.Data)[1]-1), c("Sampling.Date")] ;
x.2 <- Flux.Calc.Data[seq(2,dim.data.frame(Flux.Calc.Data)[1]), c("Sampling.Date")] ;
Delta.x <- x.2 - x.1
Delta.x
dim.data.frame(Flux.Calc.Data)
length(x.1)
length(x.2)
c(1, (x.2 - x.1))
x.2 - x.1
Delta.x <- c(1, (x.2 - x.1))
str(Delta.x)
y.1 <- Flux.Calc.Data[seq(1,dim.data.frame(Flux.Calc.Data)[1]-1), c("LR.f0.KgElement.Ha.day")] ;
y.2 <- Flux.Calc.Data[seq(2,dim.data.frame(Flux.Calc.Data)[1]), c("LR.f0.KgElement.Ha.day")] ;
length(y.1)
length(y.2)
dim.data.frame(Flux.Calc.Data)
y.1[1]
y.1.y.2 <- c(y.1[1], ((y.1 + y.2)/2))
y.1.y.2
length(y.1.y.2)
